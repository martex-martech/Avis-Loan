{% extends "core/base.html" %}

{% block title %}Collection - Loan App{% endblock %}

{% block extra_head %}
<style>
  /* Header */
  .header {
    background-color: var(--primary);
    color: white;
    padding: 16px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 50;
  }

  /* Form styling */
  form {
    margin-top: 80px;
    /* to avoid overlap with header */
    padding: 0 16px;
    width: 100%;
    box-sizing: border-box;
  }

  .form-section {
    margin-bottom: 16px;
  }

  .form-input,
  .form-select {
    width: 100%;
    max-width: 100%;
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #d1d5db;
    box-sizing: border-box;
    transition: border-color 0.2s ease, box-shadow 0.2s ease;
  }

  /* ➡️ Updated focus styles with matching box-shadow color */
  .form-input:focus,
  .form-select:focus {
    outline: none;
    border-color: var(--primary-light);
    /* RGB for #d45d30 (primary-light) */
    box-shadow: 0 0 0 3px rgba(212, 93, 48, 0.2);
  }

  /* Line + Add button layout */
  .line-add-container {
    display: flex;
    gap: 8px;
  }

  .line-add-container select {
    flex: 1;
    /* select takes remaining space */
  }

  .add-btn {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #e0e7ff;
    color: var(--primary);
    border-radius: 8px;
    text-decoration: none;
    flex-shrink: 0;
  }

  /* Submit button */
  .btn-submit {
    width: 100vw;
    /* full width */
    max-width: 100%;
    padding: 14px;
    background-color: var(--primary);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: 0.2s;
  }

  .btn-submit:hover {
    background-color: #d45d30;
  }

  /* Bottom navigation */
  .nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background-color: white;
    padding: 12px 0;
    z-index: 40;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.1);
    height: 80px;
  }

  .nav-items {
    display: flex;
    justify-content: space-around;
  }

  .nav-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: var(--text-light);
    font-size: 12px;
    padding: 4px 12px;
  }

  .nav-item i {
    font-size: 20px;
    margin-bottom: 4px;
  }

  .nav-item.active {
    color: var(--primary);
  }
</style>
{% endblock %}

{% block content %}
<header class="header">
  <div class="text-lg font-semibold">Collection</div>
  <div>
    <a href="{% url 'calculator' %}" title="Calculator">
      <i class="fas fa-calculator"></i>
    </a>
  </div>
</header>

<form method="GET" action="{% url 'collection_list' %}">
  <div class="form-section">
    <label class="block mb-2">Collection Date</label>
    <input type="date" name="date" value="{{ selected_date|default:today|date:'Y-m-d' }}" class="form-input" required>
  </div>

  <div class="form-section">
    <label class="block mb-2">Select Line</label>
    <div class="line-add-container">
      <select name="line" class="form-select" required>
        <option value="" disabled {% if not selected_line %}selected{% endif %}>Select line</option>
        {% for line in user_lines %}
        <option value="{{ line.id }}" {% if line.id|stringformat:"s" == selected_line|stringformat:"s" %}selected{% endif %}>
          {{ line.line_name }}{% if line.line_type %}{% endif %}
        </option>
        {% empty %}
        <option disabled>No lines found</option>
        {% endfor %}
      </select>
      <a href="{% url 'line_add_collection' %}" class="add-btn">
        <i class="fas fa-plus"></i>
      </a>
    </div>
  </div>

  <div class="form-section">
    <label class="block mb-2">Select Area</label>
    <select name="area" class="form-select" required>
      <option value="" disabled {% if not selected_area %}selected{% endif %}>Select area</option>
      {% for area in user_areas %}
      <option value="{{ area.id }}" {% if area.id|stringformat:"s" == selected_area|stringformat:"s" %}selected{% endif %}>
        {{ area.name }}
      </option>
      {% empty %}
      <option disabled>No areas found</option>
      {% endfor %}
    </select>
  </div>

  <button type="submit" class="btn-submit">Submit</button>
</form>

<nav class="nav">
  <div class="nav-items">
    <a href="{% url 'collection' %}" class="nav-item active">
      <i class="fas fa-coins"></i>
      <span>Collection</span>
    </a>
    <a href="{% url 'expense_list' %}" class="nav-item">
      <i class="fas fa-receipt"></i>
      <span>Expense</span>
    </a>
    <a href="{% url 'add_customer' %}" class="nav-item">
      <i class="fas fa-users"></i>
      <span>Customers</span>
    </a>
    <!-- <a href="Reports.html" class="nav-item">
        <i class="fas fa-chart-pie"></i>
        <span>Reports</span>
      </a> -->
    <a href="{% url 'settings' %}" class="nav-item">
      <i class="fas fa-cog"></i>
      <span>Settings</span>
    </a>
  </div>
</nav>
{% endblock %}